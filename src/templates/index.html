{% extends 'base.html' %}

{% block content %}
<div class="quote-container">
    <div class="quote-content">
       {% if model.show_greeting %}
            <h3 class="greeting-content">Hi <b>{{user}}</b>, hope this makes your day!</h3>
        {% else %}
            <h3 class="greeting-content">Quote of the day</h3>
        {% endif %}
        <br />
        <p class="quote">“{{model.quote.message}}”</p>
        <p>- <b>{{model.quote.author}}</b></p>
    </div>

    <div class="vote-container">
        <button class="btn btn-primary" onclick="heartClicked(this)">
            <i class="far fa-heart"></i> <!-- Heart icon -->
        </button>
    </div>

    <form action="/" method="post">
    </form>
</div>

<script>
    function heartClicked(button) {
        var icon = button.querySelector('i');
        
        // Toggle the heart icon appearance
        icon.classList.toggle('far');
        icon.classList.toggle('fas');
          // Determine if it's a like or unlike action
        const isNowLiked = icon.classList.contains('fas');
        const action = isNowLiked ? 'like' : 'unlike';
        
        // Send a request to the dedicated heart endpoint
        fetch('/heart', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                action: action
            })
        })
        .then(response => response.json())
        .catch((error) => {
            // Revert icon state if there was an error
            icon.classList.toggle('far');
            icon.classList.toggle('fas');
        });
    }
</script>
{% endblock %}